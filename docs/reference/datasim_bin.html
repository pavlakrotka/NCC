<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function simulates data from a platform trial with a given number of experimental treatment arms entering at given time points and a shared control arm. The primary endpoint is a binary endpoint. The user specifies the timing of adding arms in terms of patients recruited to the trial so far and the sample size per experimental treatment arm."><title>Simulate binary data from a platform trial with a shared control arm and a given number of experimental treatment arms entering at given time points — datasim_bin • NCC</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate binary data from a platform trial with a shared control arm and a given number of experimental treatment arms entering at given time points — datasim_bin"><meta property="og:description" content="This function simulates data from a platform trial with a given number of experimental treatment arms entering at given time points and a shared control arm. The primary endpoint is a binary endpoint. The user specifies the timing of adding arms in terms of patients recruited to the trial so far and the sample size per experimental treatment arm."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NCC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ncc_intro.html">NCC Introduction
</a>
    <a class="dropdown-item" href="../articles/datasim_bin.html">How to simulate binary data
</a>
    <a class="dropdown-item" href="../articles/datasim_cont.html">How to simulate continuous data
</a>
    <a class="dropdown-item" href="../articles/how_to_run_sim_study.html">How to run a simulation study
</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pavlakrotka/NCC">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate binary data from a platform trial with a shared control arm and a given number of experimental treatment arms entering at given time points</h1>
      <small class="dont-index">Source: <a href="https://github.com/pavlakrotka/NCC/blob/HEAD/R/datasim_bin.R" class="external-link"><code>R/datasim_bin.R</code></a></small>
      <div class="d-none name"><code>datasim_bin.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function simulates data from a platform trial with a given number of experimental treatment arms entering at given time points and a shared control arm. The primary endpoint is a binary endpoint. The user specifies the timing of adding arms in terms of patients recruited to the trial so far and the sample size per experimental treatment arm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">datasim_bin</span><span class="op">(</span>
  <span class="va">num_arms</span>,
  <span class="va">n_arm</span>,
  <span class="va">d</span>,
  period_blocks <span class="op">=</span> <span class="fl">2</span>,
  <span class="va">p0</span>,
  <span class="va">OR</span>,
  <span class="va">lambda</span>,
  <span class="va">trend</span>,
  <span class="va">N_peak</span>,
  <span class="va">n_wave</span>,
  full <span class="op">=</span> <span class="cn">FALSE</span>,
  check <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>num_arms</dt>
<dd><p>Integer. Number of experimental treatment arms in the trial.</p></dd>
<dt>n_arm</dt>
<dd><p>Integer. Sample size per experimental treatment arm (assumed equal).</p></dd>
<dt>d</dt>
<dd><p>Integer vector with timings of adding new arms in terms of number of patients recruited to the trial so far. The first entry must be 0, so that the trial starts with at least one experimental treatment arm, and the entries must be non-decreasing. The vector length equals <code>num_arms</code>.</p></dd>
<dt>period_blocks</dt>
<dd><p>Integer. Number to define the size of the blocks for the block randomization. The block size in each period equals <code>period_blocks</code>times the number of active arms in the period (see Details). Default=2.</p></dd>
<dt>p0</dt>
<dd><p>Double. Response probability in the control arm.</p></dd>
<dt>OR</dt>
<dd><p>Double vector with treatment effects in terms of odds ratios for each experimental treatment arm compared to control. The elements of the vector (odds ratios) are ordered by the entry time of the experimental treatment arms (e.g., the first entry in the vector corresponds to the odds ratio of the first experimental treatment arm). The vector length equals <code>num_arms</code>.</p></dd>
<dt>lambda</dt>
<dd><p>Double vector with strength of time trend in each arm ordered by the entry time of the arms (e.g., the first entry in the vector corresponds to the time trend in the control arm, second entry to the time trend in the first experimental treatment arm). The vector length equals <code>num_arms</code>+1, as time trend in the control is also allowed.</p></dd>
<dt>trend</dt>
<dd><p>String indicating the time trend pattern ("linear", "linear_2, "stepwise", "stepwise_2", "inv_u" or "seasonal"). See Details for more information.</p></dd>
<dt>N_peak</dt>
<dd><p>Integer. Timepoint at which the inverted-u time trend switches direction in terms of overall sample size (i.e. after how many recruited participants the trend direction switches).</p></dd>
<dt>n_wave</dt>
<dd><p>Integer. Number of cycles (waves) should the seasonal trend have.</p></dd>
<dt>full</dt>
<dd><p>Logical. Indicates whether the output should be in form of a data frame with variables needed for the analysis only (FALSE) or in form of a list containing more information (TRUE). Default=FALSE.</p></dd>
<dt>check</dt>
<dd><p>Logical. Indicates whether the input parameters should be checked by the function. Default=TRUE, unless the function is called by a simulation function, where the default is FALSE.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Data frame: simulated trial data (if full=FALSE, i.e. default) with the following columns:</p><ul><li><p><code>j</code> - patient recruitment index</p></li>
<li><p><code>response</code> - binary response for patient <code>j</code></p></li>
<li><p><code>treatment</code>- index of the treatment patient <code>j</code> was allocated to</p></li>
<li><p><code>period</code> - index of the period patient <code>j</code> was recruited in</p></li>
</ul><p>or List (if full=TRUE) containing the following elements:</p><ul><li><p><code>Data</code> - simulated trial data, including an additional column <code>p</code> with the probability used for simulating the response for patient <code>j</code></p></li>
<li><p><code>n_total</code> - total sample size in the trial</p></li>
<li><p><code>n_arm</code> - sample size per arm (assumed equal)</p></li>
<li><p><code>num_arms</code> - number of experimental treatment arms in the trial</p></li>
<li><p><code>d</code> - timings of adding new arms</p></li>
<li><p><code>SS_matrix</code> - matrix with the sample sizes per arm and per period</p></li>
<li><p><code>period_blocks</code> - number to multiply the number of active arms with, in order to get the block size per period</p></li>
<li><p><code>p0</code> - response probability in the control arm</p></li>
<li><p><code>OR</code> - odds ratios for each experimental treatment arm</p></li>
<li><p><code>lambda</code> - strength of time trend in each arm</p></li>
<li><p><code>time_dep_effect</code> - time dependent treatment effects for each experimental treatment arm (for computing the bias)</p></li>
<li><p><code>trend</code> - time trend pattern</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Design assumptions:</strong></p><ul><li><p>The simulated platform trial consists of a given number of experimental treatment arms (specified by the argument <code>num_arms</code>) and one control arm that is shared across the whole platform.</p></li>
<li><p>Participants are indexed by entry order, assuming that at each time unit exactly one participant is recruited and the time of recruitment and observation of the response are equal.</p></li>
<li><p>All participants are assumed to be eligible for all arms in the trial, i.e. the same inclusion and exclusion criteria apply to all experimental and control arms.</p></li>
<li><p>Equal sample sizes (given by parameter <code>n_arm</code>) in all experimental treatment arms are assumed.</p></li>
<li><p>The duration of the trial is divided into so-called periods, defined as time intervals bounded by distinct time points of any treatment arm entering or leaving the platform.
Hence, multiple treatment arms entering or leaving at the same time point imply the start of only one additional period.</p></li>
<li><p>Allocation ratio of 1:1:...:1 in each period. Furthermore, block randomization is used to assign patients to the active arms. Block size in each period = <code>period_blocks</code>* (number of active arms in the period).</p></li>
<li><p>If the period sample size is not a multiple of the block size, arms for the remaining participants are chosen by sampling without replacement from a vector containing the indices of active arms replicated times <code>ceiling(remaining sample size/number of active arms)</code>.</p></li>
</ul><p><strong>Data generation:</strong></p>
<p>The binary response \(y_j\) for patient \(j\) is generated according to:</p>
<p>$$g(E(y_j)) = \eta_0 + \sum_{k=1}^K \cdot I(k_j=k) + f(j)$$</p>
<p>where \(g(\cdot)\) is the logit link function, and \(\eta_0\) (logit function of parameter <code>p0</code>) and \(\theta_k\) (log of the parameter <code>OR</code>) are the log odds in the control arm and the log odds ratio of treatment \(k\). \(K\) is the total number of treatment arms in the trial (parameter <code>num_arms</code>) and \(k_j\) is an indicator of the treatment arm patient \(j\) is allocated to.</p>
<p>The function \(f(j)\) denotes the time trend, whose strength is indicated by \(\lambda_{k_j}\) (parameter <code>lambda</code>) and which can have the following patterns (parameter <code>trend</code>):</p><ul><li><p><strong>"linear"</strong> - trend starts at the beginning of the trial and the log odds increases or decreases linearly with a slope of \(\lambda\), according to the function \(f(j) = \lambda \cdot \frac{j-1}{N-1}\), where \(N\) is the total sample size in the trial</p></li>
<li><p><strong>"linear_2"</strong> - trend starts after the first period (i.e. there is no time trend in the first period) and the log odds increases or decreases linearly with a slope of \(\lambda\), according to the function \(f(j) = \lambda \cdot \frac{j-1}{N-1}\), where \(N\) is the total sample size in the trial</p></li>
<li><p><strong>"stepwise"</strong> - the log odds is constant in each period and increases or decreases by \(\lambda\) each time any treatment arm enters or leaves the trial (i.e. in each period), according to the function \(f(j) = \lambda_{k_j} \cdot (c_j - 1)\), where \(c_j\) is an index of the period patient \(j\) was enrolled in</p></li>
<li><p><strong>"stepwise_2"</strong> - the log odds is constant in each period and increases or decreases by \(\lambda\) each time a new treatment arm is added to the trial, according to the function \(f(j) = \lambda_{k_j} \cdot (w_j - 1)\), where \(w_j\) is an indicator of how many treatment arms have already entered the ongoing trial, when patient \(j\) was enrolled</p></li>
<li><p><strong>"inv_u"</strong> - the log odds increases up to the point \(N_p\) (parameter <code>N_peak</code>) and decreases afterwards, linearly with a slope of \(\lambda\), according to the function \(f(j) = \lambda \cdot \frac{j-1}{N-1} (I(j \leq N_p) - I(j &gt; N_p))\), where \(N_p\) indicates the point at which the trend turns from positive to negative in terms of the sample size (note that for negative \(\lambda\), the log odds ratio decreases first and increases after)</p></li>
<li><p><strong>"seasonal"</strong> - the log odds increases and decreases periodically with a magnitude of \(\lambda\), according to the function \(f(j) = \lambda \cdot \mathrm{sin} \big( \psi \cdot 2\pi \cdot \frac{j-1}{N-1} \big)\), where \(\psi\) indicates how many cycles should the time trend have (parameter <code>n_wave</code>)</p></li>
</ul><p>Trials with no time trend can be simulated too, by setting all elements of the vector <code>lambda</code> to zero and choosing an arbitrary pattern.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pavla Krotka, Marta Bofill Roig</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">datasim_bin</span><span class="op">(</span>num_arms <span class="op">=</span> <span class="fl">3</span>, n_arm <span class="op">=</span> <span class="fl">100</span>, d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">250</span><span class="op">)</span>,</span>
<span class="r-in">p0 <span class="op">=</span> <span class="fl">0.7</span>, OR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.8</span>, <span class="fl">3</span><span class="op">)</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">4</span><span class="op">)</span>, trend<span class="op">=</span><span class="st">"stepwise"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   j response treatment period</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1        0         0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2        0         0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 3        1         1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 4        0         1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 5        1         1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 6        0         0      1</span>
<span class="r-in"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Pavla Krotka, Marta Bofill Roig, Katharina Hees, Peter
Jacko, Dominic Magirr.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

